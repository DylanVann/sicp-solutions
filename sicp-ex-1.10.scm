(define (A x y)
  (cond ((= y 0) 0)
        ((= x 0) (* 2 y))
        ((= y 1) 2)
        (else (A (- x 1) (A x (- y 1))))))

; (A 1 10)
; Using substitution:
;
; (A 1 10)
; (A (- 1 1) (A 1 (- 10 1)))
; (A 0 (A 1 9))
; (A 0 (A (- 1 1) (A 1 (- 9 1))))
; (A 0 (A 0 (A 1 8)))
; (A 0 (A 0 (A (- 1 1) (A 1 (- 8 1)))))
; (A 0 (A 0 (A 0 (A 1 7))))
; (A 0 (A 0 (A 0 (A (- 1 1) (A 1 (- 7 1))))))
; (A 0 (A 0 (A 0 (A 0 (A 1 6)))))
; (A 0 (A 0 (A 0 (A 0 (A (- 1 1) (A 1 (- 6 1)))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 5))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A (- 1 1) (A 1 (- 5 1))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 4)))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A (- 1 1) (A 1 (- 4 1)))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 3))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A (- 1 1) (A 1 (- 3 1))))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 2)))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A (- 1 1) (A 1 (- 2 1)))))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 1))))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 2)))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (* 2 2)))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 4))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (* 2 4))))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 8)))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (* 2 8)))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 16))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 (* 2 16))))))
; (A 0 (A 0 (A 0 (A 0 (A 0 32)))))
; (A 0 (A 0 (A 0 (A 0 (* 2 32)))))
; (A 0 (A 0 (A 0 (A 0 64))))
; (A 0 (A 0 (A 0 (* 2 64))))
; (A 0 (A 0 (A 0 128)))
; (A 0 (A 0 (* 2 128)))
; (A 0 (A 0 256))
; (A 0 (A 0 256))
; (A 0 (* 2 256))
; (A 0 512)
; (* 2 512)
; 1024
(A 1 10)

; (A 2 4)
; Using substitution:
;
; (A 2 4) 
; (A 1 (A 2 3)) 
; (A 1 (A 1 (A 2 2))) 
; (A 1 (A 1 (A 1 (A 2 1)))) 
; (A 1 (A 1 (A 1 2))) 
; (A 1 (A 1 (A 0 (A 1 1)))) 
; (A 1 (A 1 (A 0 2))) 
; (A 1 (A 1 4)) 
; (A 1 (A 0 (A 1 3))) 
; (A 1 (A 0 (A 0 (A 1 2)))) 
; (A 1 (A 0 (A 0 (A 0 (A 1 1))))) 
; (A 1 (A 0 (A 0 (A 0 2)))) 
; (A 1 (A 0 (A 0 4))) 
; (A 1 (A 0 8)) 
; (A 1 16) 
; (A 0 (A 1 15)) 
; (A 0 (A 0 (A 1 14))) 
; (A 0 (A 0 (A 0 (A 1 13)))) 
; (A 0 (A 0 (A 0 (A 0 (A 1 12))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 11)))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 10))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 9)))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 8))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 7)))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 6))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 5)))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 4))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 3)))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 2))))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 1)))))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 2))))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 4)))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 8))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 16)))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 32))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 64)))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 128))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 256)))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 512))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 1024)))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 2048))))) 
; (A 0 (A 0 (A 0 (A 0 4096)))) 
; (A 0 (A 0 (A 0 8192))) 
; (A 0 (A 0 16384)) 
; (A 0 32768) 
; 65536 
(A 2 4) 1 (A 2 3)) 


; (A 3 3)
; Using substitution:
;
; (A 3 3)
; (A (- 3 1) (A 3 (- 3 1)))
; (A 2 (A 3 2))
; (A 2 (A (- 3 1) (A 3 (- 2 1))))
; (A 2 (A 2 (A 3 1)))
; (A 2 (A 2 2))
; (A 2 (A (- 2 1) (A 2 (- 2 1))))
; (A 2 (A 1 (A 2 1)))
; (A 2 (A 1 2))
; (A 2 (A (- 1 1) (A 1 (- 2 1))))
; (A 2 (A 0 (A 1 1)))
; (A 2 (A 0 2))
; (A 2 (* 2 2))
; (A 2 4)
; (A 1 (A 2 3)) 
; (A 1 (A 1 (A 2 2))) 
; (A 1 (A 1 (A 1 (A 2 1)))) 
; (A 1 (A 1 (A 1 2))) 
; (A 1 (A 1 (A 0 (A 1 1)))) 
; (A 1 (A 1 (A 0 2))) 
; (A 1 (A 1 4)) 
; (A 1 (A 0 (A 1 3))) 
; (A 1 (A 0 (A 0 (A 1 2)))) 
; (A 1 (A 0 (A 0 (A 0 (A 1 1))))) 
; (A 1 (A 0 (A 0 (A 0 2)))) 
; (A 1 (A 0 (A 0 4))) 
; (A 1 (A 0 8)) 
; (A 1 16) 
; (A 0 (A 1 15)) 
; (A 0 (A 0 (A 1 14))) 
; (A 0 (A 0 (A 0 (A 1 13)))) 
; (A 0 (A 0 (A 0 (A 0 (A 1 12))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 11)))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 10))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 9)))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 8))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 7)))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 6))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 5)))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 4))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 3)))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 2))))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 1 1)))))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 2))))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 4)))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 8))))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 16)))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 32))))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 64)))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 128))))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 256)))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 512))))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 (A 0 1024)))))) 
; (A 0 (A 0 (A 0 (A 0 (A 0 2048))))) 
; (A 0 (A 0 (A 0 (A 0 4096)))) 
; (A 0 (A 0 (A 0 8192))) 
; (A 0 (A 0 16384)) 
; (A 0 32768) 
; 65536 
(A 3 3)

; Computes 2*n
(define (f n) (A 0 n))
(f 0)
(f 1)
(f 2)
(f 3)
(f 4)

; Computes 2^n
(define (g n) (A 1 n))
(g 0)
(g 1)
(g 2)
(g 3)
(g 4)

; Computes 2^h(n-1)
; h(0) = 0 = 2^0
; h(1) = 2 = 2^1
; h(2) = 4 = 2^2
; h(3) = 16 = 2^4
; h(4) = 65536 = 2^16
(define (h n) (A 2 n))
(h 0)
(h 1)
(h 2)
(h 3)
(h 4)

; Computes 5*n^2
(define (k n) (* 5 n n))
(k 0)
(k 1)
(k 2)
(k 3)
(k 4)